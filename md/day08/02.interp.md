# π“`Spring Interceptor`
- μ¤ν”„λ§ MVCμ—μ„ μ κ³µν•λ©° μ„λΈ”λ¦Ώμ ν•„ν„°μ™€ μ μ‚¬ν•λ‹¤.
   > λ‹¤λ§ μ μ©λλ” μμ„μ™€ λ²”μ„, μ‚¬μ© λ°©λ²•μ΄ λ‹¤λ¥΄λ‹¤.

## π¶μ¤ν”„λ§ μΈν„°μ…‰ν„°μ νλ¦„
![spring interceptor](/md/day08/img/interceptor_flow.jpg)
- `HTTP Request -> WAS -> Filter -> Servlet -> Interceptor -> Controller ...`
- μ¤ν”„λ§ μΈν„°μ…‰ν„°λ” λ””μ¤ν¨μ² μ„λΈ”λ¦Ώ μ΄ν›„μ— λ“±μ¥ν•λ©°, Dispatcher Servletκ³Ό Controller μ‚¬μ΄μ—μ„ Controller νΈμ¶ μ§μ „μ— μΈν„°μ…‰ν„°κ°€ νΈμ¶λλ‹¤.
   > Dispatcher Servletλ” Front Controller μ—­ν• μ„ μν–‰ν•λ©°, μ¤ν”„λ§ MVCμ μ‹μ‘μ μΌλ΅ μ΄ν•΄ν•΄λ„ μΆ‹λ‹¤.
- μ¤ν”„λ§ μΈν„°μ…‰ν„°μ—λ„ URL ν¨ν„΄μ„ μ μ©ν•  μ μλ”λ°, μ„λΈ”λ¦Ώ URL ν¨ν„΄κ³Όλ” λ‹¤λ¥΄κ³ , λ³΄λ‹¤ μ •λ°€ν•κ² μ„¤μ •ν•  μ μλ‹¤.

## π¶μ¤ν”„λ§ μΈν„°μ…‰ν„° μ²΄μΈ
- `HTTP Request -> WAS -> Filter 1, 2, ..n -> Servlet -> Interceptor 1, 2, ..n  -> Controller ...`
- μ¤ν”„λ§ μΈν„°μ…‰ν„°λ” μ²΄μΈμΌλ΅ κµ¬μ„±λλ”λ°, μ¤‘κ°„μ— μΈν„°μ…‰ν„°λ¥Ό μμ λ΅­κ² μ¶”κ°€ν•  μ μλ‹¤.
- μ„λΈ”λ¦Ώ ν•„ν„°λ³΄λ‹¤ νΈλ¦¬ν•κ³  λ” μ •κµν•κ³  λ‹¤μ–‘ν• κΈ°λ¥μ„ μ§€μ›ν•λ‹¤.

## π¶μ¤ν”„λ§ μΈν„°μ…‰ν„° κµ¬ν„
![spring interceptor](/md/day08/img/handlerInterceptor.jpg)
- interface `HandlerInterceptor`λ΅ κµ¬ν„ν•λ‹¤.
- μΈν„°μ…‰ν„°λ” νΈμ¶ μ „(`preHandle()`), νΈμ¶ ν›„(`postHandle()`), μ”μ²­ μ™„λ£ μ΄ν›„(`afterCompletion()`) κ°™μ΄ λ‹¨κ³„μ μΌλ΅ μ„Έλ¶„ν™” λμ–΄ μλ‹¤.
- Request, Responseμ™Έμ—λ„ handler(μ–΄λ–¤ μ»¨νΈλ΅¤λ¬κ°€ νΈμ¶λ  μ§€)μ •λ³΄ κ·Έλ¦¬κ³  ModelAndView μ •λ³΄λ„ λ°›μ•„λ³Ό μ μλ‹¤.

### `.order()`
- μΈν„°μ…‰ν„° νΈμ¶ μμ„ μ§€μ •

### `.addPathPatterns()`
- μ μ© URI μ§€μ •
   - λ‘ κ° μ΄μƒμ νμ΄μ§€μ— μ¤‘λ³µν•μ—¬ μΈν„°μ…‰ν„°λ¥Ό μ μ©.
      ```java
      public void addInterceptors(InterceptorRegistry registry) {
         registry.addInterceptor(new LogInterceptor())
         .order(1)
         .addPathPatterns("/sub1/test1", "/sub1/test2");
      }
      ```
   - 1κ°μ λ¨λ“  κ²½λ΅μ— μ μ©
      ```java
      public void addInterceptors(InterceptorRegistry registry) {
         registry.addInterceptor(new LogInterceptor())
         .order(1)
         .addPathPatterns("/sub1/*");
      }
      ```
   - 1κ°λ¥Ό λ„μ–΄μ„ λ¨λ“  κ²½λ΅μ— μΈν„°μ…‰ν„°λ¥Ό μ μ©
      ```java
      public void addInterceptors(InterceptorRegistry registry) {
         registry.addInterceptor(new LogInterceptor())
         .order(1)
         .addPathPatterns("/**");
      }
      ```

### `.excludePathPatterns()`
- μ μ™Έ μ‹ν‚¬ URI μ§€μ •